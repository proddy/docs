<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation (Wiki) for EMS-ESP"><link href=https://emsesp.org/Configuring/ rel=canonical><link href=../Getting-Started/ rel=prev><link href=../Special-Functions/ rel=next><link rel=icon href=../_media/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.34"><title>Configuring - EMS-ESP</title><link rel=stylesheet href=../assets/stylesheets/main.35f28582.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><link rel=stylesheet href=../assets/css/github.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-SVDSJ3QTVC"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-SVDSJ3QTVC",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-SVDSJ3QTVC",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#setting-up-for-the-first-time class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=EMS-ESP class="md-header__button md-logo" aria-label=EMS-ESP data-md-component=logo> <img src=../_media/logo/boiler.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EMS-ESP </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Configuring </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-hidden=true type=radio name=__palette id=__palette_0> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/emsesp/EMS-ESP32 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> emsesp/EMS-ESP32 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class="md-tabs__item md-tabs__item--active"> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../All-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../Integrations/ class=md-tabs__link> Integrations </a> </li> <li class=md-tabs__item> <a href=../Support/ class=md-tabs__link> Help </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=EMS-ESP class="md-nav__button md-logo" aria-label=EMS-ESP data-md-component=logo> <img src=../_media/logo/boiler.svg alt=logo> </a> EMS-ESP </label> <div class=md-nav__source> <a href=https://github.com/emsesp/EMS-ESP32 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> emsesp/EMS-ESP32 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> News </span> </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> <span class=md-ellipsis> About EMS-ESP </span> </a> </li> <li class=md-nav__item> <a href=../Version-Release-History/ class=md-nav__link> <span class=md-ellipsis> Version Release History </span> </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Configuring </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Configuring </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#setting-up-for-the-first-time class=md-nav__link> <span class=md-ellipsis> Setting up for the first time </span> </a> </li> <li class=md-nav__item> <a href=#application-settings class=md-nav__link> <span class=md-ellipsis> Application Settings </span> </a> <nav class=md-nav aria-label="Application Settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#board-profile class=md-nav__link> <span class=md-ellipsis> Board Profile </span> </a> </li> <li class=md-nav__item> <a href=#ems-bus class=md-nav__link> <span class=md-ellipsis> EMS Bus </span> </a> </li> <li class=md-nav__item> <a href=#general-options class=md-nav__link> <span class=md-ellipsis> General Options </span> </a> </li> <li class=md-nav__item> <a href=#formatting-options class=md-nav__link> <span class=md-ellipsis> Formatting Options </span> </a> </li> <li class=md-nav__item> <a href=#temperature-sensors class=md-nav__link> <span class=md-ellipsis> Temperature Sensors </span> </a> </li> <li class=md-nav__item> <a href=#logging-to-syslog class=md-nav__link> <span class=md-ellipsis> Logging to Syslog </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setting-up-the-network class=md-nav__link> <span class=md-ellipsis> Setting up the Network </span> </a> <nav class=md-nav aria-label="Setting up the Network"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cors-cross-origin-resource-sharing class=md-nav__link> <span class=md-ellipsis> CORS (Cross-Origin Resource Sharing) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setting-up-mqtt class=md-nav__link> <span class=md-ellipsis> Setting up MQTT </span> </a> </li> <li class=md-nav__item> <a href=#managing-users class=md-nav__link> <span class=md-ellipsis> Managing Users </span> </a> </li> <li class=md-nav__item> <a href=#adding-analog-and-temperature-sensors class=md-nav__link> <span class=md-ellipsis> Adding Analog and Temperature Sensors </span> </a> <nav class=md-nav aria-label="Adding Analog and Temperature Sensors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#controlling-relays class=md-nav__link> <span class=md-ellipsis> Controlling Relay's </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#customizing-entities class=md-nav__link> <span class=md-ellipsis> Customizing Entities </span> </a> </li> <li class=md-nav__item> <a href=#scheduling-actions class=md-nav__link> <span class=md-ellipsis> Scheduling Actions </span> </a> <nav class=md-nav aria-label="Scheduling Actions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#conditions class=md-nav__link> <span class=md-ellipsis> Conditions </span> </a> </li> <li class=md-nav__item> <a href=#web-commands class=md-nav__link> <span class=md-ellipsis> Web Commands </span> </a> </li> <li class=md-nav__item> <a href=#notification class=md-nav__link> <span class=md-ellipsis> Notification </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adding-custom-entities class=md-nav__link> <span class=md-ellipsis> Adding Custom Entities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Special-Functions/ class=md-nav__link> <span class=md-ellipsis> Special Functions </span> </a> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> <span class=md-ellipsis> WebUI </span> </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_9> <label class=md-nav__link for=__nav_1_9 id=__nav_1_9_label tabindex=0> <span class=md-ellipsis> Modbus/TCP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_9_label aria-expanded=false> <label class=md-nav__title for=__nav_1_9> <span class="md-nav__icon md-icon"></span> Modbus/TCP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Modbus/ class=md-nav__link> <span class=md-ellipsis> Modbus </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Settings/ class=md-nav__link> <span class=md-ellipsis> Settings </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Server-IDs/ class=md-nav__link> <span class=md-ellipsis> Server Unit Identifiers </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-System-Server/ class=md-nav__link> <span class=md-ellipsis> The SYSTEM Server </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Register-Blocks/ class=md-nav__link> <span class=md-ellipsis> Register Block Offsets </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Entity-Registers/ class=md-nav__link> <span class=md-ellipsis> Entity Register Offsets </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../Console/ class=md-nav__link> <span class=md-ellipsis> Console </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_12> <label class=md-nav__link for=__nav_1_12 id=__nav_1_12_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_12_label aria-expanded=false> <label class=md-nav__title for=__nav_1_12> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../All-Devices/ class=md-nav__link> <span class=md-ellipsis> All Devices and Entities </span> </a> </li> <li class=md-nav__item> <a href=../Boilers/ class=md-nav__link> <span class=md-ellipsis> Boilers </span> </a> </li> <li class=md-nav__item> <a href=../Thermostats/ class=md-nav__link> <span class=md-ellipsis> Thermostats </span> </a> </li> <li class=md-nav__item> <a href=../Solar-Modules/ class=md-nav__link> <span class=md-ellipsis> Solar Modules </span> </a> </li> <li class=md-nav__item> <a href=../Mixer-Modules/ class=md-nav__link> <span class=md-ellipsis> Mixer Modules </span> </a> </li> <li class=md-nav__item> <a href=../Heat-Pumps/ class=md-nav__link> <span class=md-ellipsis> Heat Pumps </span> </a> </li> <li class=md-nav__item> <a href=../Controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../Switches/ class=md-nav__link> <span class=md-ellipsis> Switches </span> </a> </li> <li class=md-nav__item> <a href=../Other-Devices/ class=md-nav__link> <span class=md-ellipsis> Other Devices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_13> <label class=md-nav__link for=__nav_1_13 id=__nav_1_13_label tabindex=0> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_13_label aria-expanded=false> <label class=md-nav__title for=__nav_1_13> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> </li> <li class=md-nav__item> <a href=../IOBroker/ class=md-nav__link> <span class=md-ellipsis> IOBroker </span> </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> <span class=md-ellipsis> Domoticz </span> </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> <span class=md-ellipsis> openHAB </span> </a> </li> <li class=md-nav__item> <a href=../Loxone/ class=md-nav__link> <span class=md-ellipsis> Loxone </span> </a> </li> <li class=md-nav__item> <a href=../Grafana/ class=md-nav__link> <span class=md-ellipsis> Grafana </span> </a> </li> <li class=md-nav__item> <a href=../Modbus/ class=md-nav__link> <span class=md-ellipsis> Modbus </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_14> <label class=md-nav__link for=__nav_1_14 id=__nav_1_14_label tabindex=0> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_14_label aria-expanded=false> <label class=md-nav__title for=__nav_1_14> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Support/ class=md-nav__link> <span class=md-ellipsis> Support </span> </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../tips-and-tricks/ class=md-nav__link> <span class=md-ellipsis> Tips & Tricks </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_15> <label class=md-nav__link for=__nav_1_15 id=__nav_1_15_label tabindex=0> <span class=md-ellipsis> For Developers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_15_label aria-expanded=false> <label class=md-nav__title for=__nav_1_15> <span class="md-nav__icon md-icon"></span> For Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Building/ class=md-nav__link> <span class=md-ellipsis> Building & Testing the Firmware </span> </a> </li> <li class=md-nav__item> <a href=../Adding-Languages/ class=md-nav__link> <span class=md-ellipsis> Adding Languages </span> </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../EMS-bus/ class=md-nav__link> <span class=md-ellipsis> The EMS protocol </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Dev/ class=md-nav__link> <span class=md-ellipsis> Maintaining Modbus Parameters </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../All-Devices/ class=md-nav__link> <span class=md-ellipsis> All Devices and Entities </span> </a> </li> <li class=md-nav__item> <a href=../Boilers/ class=md-nav__link> <span class=md-ellipsis> Boilers </span> </a> </li> <li class=md-nav__item> <a href=../Thermostats/ class=md-nav__link> <span class=md-ellipsis> Thermostats </span> </a> </li> <li class=md-nav__item> <a href=../Solar-Modules/ class=md-nav__link> <span class=md-ellipsis> Solar Modules </span> </a> </li> <li class=md-nav__item> <a href=../Mixer-Modules/ class=md-nav__link> <span class=md-ellipsis> Mixer Modules </span> </a> </li> <li class=md-nav__item> <a href=../Heat-Pumps/ class=md-nav__link> <span class=md-ellipsis> Heat Pumps </span> </a> </li> <li class=md-nav__item> <a href=../Controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../Switches/ class=md-nav__link> <span class=md-ellipsis> Switches </span> </a> </li> <li class=md-nav__item> <a href=../Other-Devices/ class=md-nav__link> <span class=md-ellipsis> Other Devices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> </li> <li class=md-nav__item> <a href=../IOBroker/ class=md-nav__link> <span class=md-ellipsis> IOBroker </span> </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> <span class=md-ellipsis> Domoticz </span> </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> <span class=md-ellipsis> openHAB </span> </a> </li> <li class=md-nav__item> <a href=../Loxone/ class=md-nav__link> <span class=md-ellipsis> Loxone </span> </a> </li> <li class=md-nav__item> <a href=../Grafana/ class=md-nav__link> <span class=md-ellipsis> Grafana </span> </a> </li> <li class=md-nav__item> <a href=../Modbus/ class=md-nav__link> <span class=md-ellipsis> Modbus </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Support/ class=md-nav__link> <span class=md-ellipsis> Support </span> </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../tips-and-tricks/ class=md-nav__link> <span class=md-ellipsis> Tips & Tricks </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#setting-up-for-the-first-time class=md-nav__link> <span class=md-ellipsis> Setting up for the first time </span> </a> </li> <li class=md-nav__item> <a href=#application-settings class=md-nav__link> <span class=md-ellipsis> Application Settings </span> </a> <nav class=md-nav aria-label="Application Settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#board-profile class=md-nav__link> <span class=md-ellipsis> Board Profile </span> </a> </li> <li class=md-nav__item> <a href=#ems-bus class=md-nav__link> <span class=md-ellipsis> EMS Bus </span> </a> </li> <li class=md-nav__item> <a href=#general-options class=md-nav__link> <span class=md-ellipsis> General Options </span> </a> </li> <li class=md-nav__item> <a href=#formatting-options class=md-nav__link> <span class=md-ellipsis> Formatting Options </span> </a> </li> <li class=md-nav__item> <a href=#temperature-sensors class=md-nav__link> <span class=md-ellipsis> Temperature Sensors </span> </a> </li> <li class=md-nav__item> <a href=#logging-to-syslog class=md-nav__link> <span class=md-ellipsis> Logging to Syslog </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setting-up-the-network class=md-nav__link> <span class=md-ellipsis> Setting up the Network </span> </a> <nav class=md-nav aria-label="Setting up the Network"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cors-cross-origin-resource-sharing class=md-nav__link> <span class=md-ellipsis> CORS (Cross-Origin Resource Sharing) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#setting-up-mqtt class=md-nav__link> <span class=md-ellipsis> Setting up MQTT </span> </a> </li> <li class=md-nav__item> <a href=#managing-users class=md-nav__link> <span class=md-ellipsis> Managing Users </span> </a> </li> <li class=md-nav__item> <a href=#adding-analog-and-temperature-sensors class=md-nav__link> <span class=md-ellipsis> Adding Analog and Temperature Sensors </span> </a> <nav class=md-nav aria-label="Adding Analog and Temperature Sensors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#controlling-relays class=md-nav__link> <span class=md-ellipsis> Controlling Relay's </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#customizing-entities class=md-nav__link> <span class=md-ellipsis> Customizing Entities </span> </a> </li> <li class=md-nav__item> <a href=#scheduling-actions class=md-nav__link> <span class=md-ellipsis> Scheduling Actions </span> </a> <nav class=md-nav aria-label="Scheduling Actions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#conditions class=md-nav__link> <span class=md-ellipsis> Conditions </span> </a> </li> <li class=md-nav__item> <a href=#web-commands class=md-nav__link> <span class=md-ellipsis> Web Commands </span> </a> </li> <li class=md-nav__item> <a href=#notification class=md-nav__link> <span class=md-ellipsis> Notification </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adding-custom-entities class=md-nav__link> <span class=md-ellipsis> Adding Custom Entities </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Configuring</h1> <h2 id=setting-up-for-the-first-time>Setting up for the first time<a class=headerlink href=#setting-up-for-the-first-time title="Permanent link">~</a></h2> <p>After uploading the firmware for the first time, it will use with the default settings and start an WiFi Access Point called <code>ems-esp</code>. Connect to this using the default WPA password <code>ems-esp-neo</code>. When prompted with a login screen (called a captive portal) sign-in with username <code>admin</code> and password <code>admin</code>.</p> <p>Now you're ready to further configure the settings. The recommended first step is to connect to your home network and this can be configured through the Network menu option on the web page, or directly using a Telnet Command Line interface (CLI). If you haven't adjusted the hostname you can reach the web UI via <a href=http://ems-esp>http://ems-esp</a> or <a href=http://ems-esp.local>http://ems-esp.local</a>.</p> <p>Next are the board settings and some other MQTT tweaking which you can read below.</p> <p>If you're seeing warnings that it failed to connect to the EMS bus, or there are Tx or Rx errors then follow the <a href=../Troubleshooting/ >troubleshooting</a> guide.</p> <div class="admonition note"> <p class=admonition-title>If Rx incomplete telegrams are reported in the log, don't panic. Some telegrams can be missed and this is usually caused by noise interference on the line.</p> </div> <h2 id=application-settings>Application Settings<a class=headerlink href=#application-settings title="Permanent link">~</a></h2> <p>This next section describes some of key application settings that can be configured via the WebUI, found under the Settings menu.</p> <h3 id=board-profile>Board Profile<a class=headerlink href=#board-profile title="Permanent link">~</a></h3> <ul> <li>If you have your own ESP32 development board you can choose from a pre-configured board (which is already set on a BBQKees Gateway) or select <code>Custom</code> to view and change the hardware settings:</li> <li><strong>Rx GPIO</strong> - Which GPIO pin the Rx is assigned to. By default this is GPIO 23 but it can be almost any free pin. Connect this GPIO pin to the RX port on the EMS interface board.</li> <li><strong>Tx GPIO</strong> - Which GPIO pin the Tx is assigned to. By default this is GPIO 5 but it can be almost any free pin. Connect this GPIO pin to the TX port on the EMS interface board.</li> <li><strong>Button GPIO</strong>. Set a pin with pull-up. The button is used for different functions, such as holding for 10 seconds to reset to factory settings.</li> <li><strong>Temperature GPIO</strong>. This is the pin where any external temperature sensors are attached. The Dallas chips DS1822, DS18S20, DS18B20, DS1825 are supported including their parasite varieties and can also be daisy-chained onto a single line, up to 100 sensors.</li> <li><strong>LED GPIO</strong>. This is the pin for the LED, defaulted to the onboard LED on the ESP dev board.</li> <li><strong>Eth PHY Type</strong> for choosing the Ethernet chip used.</li> </ul> <div class="admonition note"> <p class=admonition-title>On ESP32 development boards there are often also pins marked RX and TX. However, these are usually connected to the USB chip and cannot be used for the EMS interface circuit.</p> </div> <h3 id=ems-bus>EMS Bus<a class=headerlink href=#ems-bus title="Permanent link">~</a></h3> <ul> <li><strong>Tx Mode</strong>. Tx Mode is the mode in which EMS-ESP sends telegrams on the EMS bus. Choose the mode that works best for your system and watch for Tx errors in the Web Dashboard and <code>show ems</code> in the Console. Changing the value has immediate effect.</li> <li><code>EMS</code> is the default for EMS1.0 systems but also compatible with most other bus protocols.</li> <li><code>EMS+</code> is designed to work better for EMS2.0/EMS+ systems.</li> <li><code>HT3</code> for Heatronics3 used primarily by Junkers.</li> <li><code>Hardware</code> uses the internal ESP's hardware to send out the telegram. Telegrams are sent immediately. It is the fastest and most efficient method but works only on some systems.</li> <li><strong>Bus ID</strong>. The EMS-ESP can simulate multiple devices. Stick to the <code>Service Key (0x0B)</code> unless using more than one EMS gateways/interface board.</li> </ul> <h3 id=general-options>General Options<a class=headerlink href=#general-options title="Permanent link">~</a></h3> <ul> <li><strong>Language</strong>. This sets the language to be used for the EMS Device Entity names, as shown in the WebUI Devices Dashboard and also for MQTT Discovery. The default is English. When using Home Assistant you may need to remove the previous EMS-ESP MQTT entries (from HA's Settings-&gt;Devices &amp; Services-&gt;MQTT) and restart EMS-ESP just to be sure.</li> <li><strong>Hide LED</strong>. Turns off the LED when in normal operating mode. The LED is still shown when booting or when there are connection issues.</li> <li><strong>Enable Telnet Console</strong>. This is on by default and allows users to connect to the in-secure Telnet server on port 23.</li> <li><strong>Enable Analog Sensors</strong>. This enables any GPIO to collect signals, whether it's a digital I/O, a pulse counter or ADC measuring mv.</li> <li><strong>Convert temperature values to Fahrenheit</strong>. For our US friends.</li> <li><strong>Bypass Access Token authorization on API calls</strong>. For RESTful write commands via HTTP POST the access token is required. This is for security reasons to prevent anyone changing device settings. Setting this flag makes the API open. Not recommended!</li> <li><strong>Enable Read only mode</strong>. This disables any outgoing Tx write commands to the EMS bus, essentially putting EMS-ESP into listening mode. However Tx is needed to detect EMS devices (as it sends out a Version command). If you want to explicitly put EMS-ESP into a read-only/sniffer mode use <code>set tx_mode 0</code> from the console.</li> <li><strong>Underclock CPU speed</strong>. Under-clocks the ESP to 160Mhz, saving on power, heat and prolonging the lifespan of the chip at the cost of performance and response time. A reboot of EMS-ESP is required.</li> <li><strong>Enable Shower Timer</strong>. Enable to time how long the hot water runs for and it will send out an MQTT message with the duration. The timer starts after a minimal of 2 minutes running time.</li> <li><strong>Enable Shower Alert</strong>. This is somewhat experimental and may not work on all boilers. After 7 minutes (configurable) running the hot water it will send out a warning by sending cold water for 10 seconds (also configurable). The boiler goes into test mode to perform this operation so use with caution!</li> </ul> <h3 id=formatting-options>Formatting Options<a class=headerlink href=#formatting-options title="Permanent link">~</a></h3> <ul> <li><strong>Boolean Format Dashboard</strong>. This is how boolean values are displayed in the WebUI and MQTT payloads.</li> <li><strong>Boolean Format API/MQTT</strong>. This is how boolean values are written in the MQTT payloads and API JSON output.</li> <li><strong>Enum Format API/MQTT</strong>. This is how list values are presented in the MQTT payloads and API JSON, either by it's value or the index position within the list. Not if using Home Assitant you will not see the values but integer numbers for some entities, e.g. instead of <code>off, hot, cold</code> it will display <code>0, 1, 2</code>.</li> </ul> <h3 id=temperature-sensors>Temperature Sensors<a class=headerlink href=#temperature-sensors title="Permanent link">~</a></h3> <ul> <li><strong>Enable parasite power</strong>. Select this option when using (Dallas) temperature sensors with parasitic power.</li> </ul> <h3 id=logging-to-syslog>Logging to Syslog<a class=headerlink href=#logging-to-syslog title="Permanent link">~</a></h3> <ul> <li><strong>Log EMS telegrams in hexadecimal</strong> will write the telegrams in raw format as hexadecimal values everywhere.</li> <li> <p><strong>Enable Syslog</strong>: <!-- prettier-ignore --></p> </li> <li> <p><strong>IP</strong> is the IP address of a syslog server for capturing remote logs. Leave blank is not using SysLog.</p> </li> <li><strong>Port</strong> if using an alternate port number. The default is 514. And it uses UDP (not TCP).</li> <li><strong>Log Level</strong> sets the maximum log level for reported messages. The highest level is DEBUG which will send a lot of log data so use with caution.</li> <li><strong>Mark Interval</strong> will send out a special <code>mark</code> message to the SysLog. This is useful for timing events.</li> </ul> <h2 id=setting-up-the-network>Setting up the Network<a class=headerlink href=#setting-up-the-network title="Permanent link">~</a></h2> <p>The Network page allows you to connect EMS-ESP to your home network. You can choose between WiFi or Ethernet. EMS-ESP will auto-detect which and set the settings accordingly. Anything in the Board Profile will override these settings.</p> <h3 id=cors-cross-origin-resource-sharing>CORS (Cross-Origin Resource Sharing)<a class=headerlink href=#cors-cross-origin-resource-sharing title="Permanent link">~</a></h3> <p>CORS, when enabled adds new HTTP headers to each Web request to allow the Web API to make <code>fetch</code> and <code>XMLHttpRequest</code> requests across different domains. It disables the pre-flight check which follows the same-origin policy by default. See <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS>https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</a> for more details. There is also a "CORS unblock" browser addon that works the same way.</p> <p>Enable this function when running in VPNs or you have other servers (like Grafana) running on other domains that are making calls to EMS-ESP's API.</p> <h2 id=setting-up-mqtt>Setting up MQTT<a class=headerlink href=#setting-up-mqtt title="Permanent link">~</a></h2> <p>Most are self-explanatory and the settings that are specific to EMS-ESP are:</p> <ul> <li><strong>Broker Address</strong>. Use the IP address.</li> <li><strong>Port</strong>. The default is 1883 and 8883 for SSL.</li> <li><strong>Base</strong>. All topics are prefixed with the <code>Base</code> so this is important. Make sure this is unique when using more than one EMS-ESP.</li> <li><strong>Client ID</strong>. This is used internally to identify EMS-ESP with the broker and is optional. Note MQTT topics will be postfixed with the hostname (default <code>ems-esp</code>) and not the client ID. Use when having multiple devices.</li> <li><strong>Username</strong> and <strong>Password</strong> are optional.</li> <li><strong>Set Clean Session</strong>. Creates a non-persistent session when enabled. Default is disabled and is recommended to keep it disabled when using home automation systems.</li> <li><strong>QoS</strong>. Quality of Service, 0, 1 or 2. 0 is the default and suitable for more scenarios. 1 will give a guarantee that the message has been sent, but will create slightly more traffic and overhead.</li> <li><strong>Always use Retain Flag</strong>. Enable if you want to persist all the messages on the broker. Default is disabled.</li> <li><strong>Formatting</strong>. The <code>As individual topics</code> option will send all data as separate topics, and <code>Nested</code> will group the data into one single JSON payload. The default is nested.</li> <li><strong>Publish command output to a 'response' topic'</strong>. This takes the output from an API command (e.g. read) and publishes the result in a topic called <code>response</code>.</li> <li><strong>Publish single value topics on change</strong>. This option will immediately publish the topic and payload for each operation and only available when MQTT Discovery is disabled.</li> <li> <p><strong>Enable MQTT Discovery</strong>. Enables the integration with Home Assistant and Domoticz. <!-- - prettier-ignore --></p> <ul> <li><strong>Entity ID format</strong>: There are 3 options. The first <code>single instance, long names</code> uses the older &lt; v3.5 format. The default and recommended setting for all new installs is the 2nd option called <code>Single instance, short name</code> which uses the EMS-ESP device entity name, which is fixed and can be seen in the <code>Settings-&gt;Customization</code> page. The last option must be used when running more than one version of the EMS-ESP firmware as it makes each unique by prefixing all MQTT topics with the base name.</li> <li><strong>Publish Intervals</strong>. This section is per device and sets how frequent an MQTT message is sent. When set to 0 EMS-ESP will send data automatically when there is a noticeable change, which could be within a few seconds.</li> </ul> </li> </ul> <h2 id=managing-users>Managing Users<a class=headerlink href=#managing-users title="Permanent link">~</a></h2> <p>The Security page allows you to change the default password for the captive portal and Telnet CLI. It also allows you to enable HTTPS for the captive portal and MQTT broker.</p> <p>The Users page allows you to create additional users for the captive portal and Telnet CLI. The default user is <code>admin</code> with password <code>admin</code>.</p> <p>Each user has an unique Access Token (viewable by clicking on the key icon) which is used for RESTful write commands via HTTP POST. This is for security reasons to prevent anyone changing device settings.</p> <p><img alt=Web src=../_media/screenshot/web_users.png></p> <h2 id=adding-analog-and-temperature-sensors>Adding Analog and Temperature Sensors<a class=headerlink href=#adding-analog-and-temperature-sensors title="Permanent link">~</a></h2> <p>External sensors, like temperature and analog sensors can be attached to a range of GPIO pins on the ESP32 chip. If using a BBQKees Gateway board it already has an external plug for Dallas temperature sensors which will be visible in the WebUI without any additional configuration.</p> <p>To add analog sensors click on <code>Add Analog Sensor</code> and choose between a normal Digital in/out, a Counter (counting on/off pulses), ADC for measuring voltages, Timer, Rate and PWM 0-2. Note, the counter value is persisted and and not reset on reboot.</p> <p><img alt=Web src=../_media/screenshot/web_sensor.png></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Be careful when picking a GPIO so it doesn't clash with the other used GPIOs (you can select CUSTOM board profile to view your current configuration).</p> <p>EMS-ESP is connected to the low voltage bus of your heating and any over-voltage can damage the EMS-ESP board and possible your heating devices. Never power external equipment from the EMS-ESP board directly.</p> <p>ESP32 development boards vary in their available pin configuration. Typically you can't use 1, 6-11, 12, 14, 15, 20, 24, 28-31 and 40+. See these links <a href=https://diyprojects.io/esp32-how-to-use-gpio-digital-io-arduino-code/#.YFpVEq9KhjG>here</a> and <a href=https://nodemcu.readthedocs.io/en/dev-esp32/modules/gpio/ >here</a>.</p> </div> <p>The following GPIOs are recommended:</p> <ul> <li>digital output: <code>13, 19, 21, 22, 27, 33, 37, 38</code></li> <li>digital input/counter/timer/rate: <code>13, 19, 21, 22, 25, 26, 27, 33, 35, 37, 38, 39 (note no pullup on 35 &amp; 39)</code></li> <li>ADC input: <code>13, 19, 21, 22, 25, 26, 27, 33, 35, 37, 38, 39</code></li> <li>DAC output: <code>25, 26</code></li> <li>PWM output: <code>13, 19, 21, 22, 25, 26, 27, 33, 37, 38</code></li> </ul> <p>Limits:</p> <ul> <li>ADC: <code>1.5V</code></li> <li>DAC <code>8bit</code></li> <li>PWM: `max frequency 5000Hz, resolution 13bits``</li> <li>Counter/timer/rate trigger: <code>high-&gt;low edge with 15 ms debounce. Only for low pulse rates.</code></li> </ul> <h3 id=controlling-relays>Controlling Relay's<a class=headerlink href=#controlling-relays title="Permanent link">~</a></h3> <p>A common use case is to control a relay to switch on/off a device. This can be done by adding a digital output sensor and then creating a command to control it. The command can be added to the dashboard and scheduled to turn on/off at specific times.</p> <p>Create an Analog Sensor with type 'Digital Out'.</p> <p>The professional way is to use a separate relay board with opto-isolation and a flyback diode. The relay board is then powered by a separate power supply and the relay is connected to the digital output of the EMS-ESP as described above. The relay board is then connected to the device you want to control. This way the device is completely isolated from the EMS-ESP and the relay board can handle the higher voltage and current.</p> <h2 id=customizing-entities>Customizing Entities<a class=headerlink href=#customizing-entities title="Permanent link">~</a></h2> <p>The Customization page shows all registered entities and allows to exclude commands and values from publishing via mqtt/api or remove them from dashboard. The dashboard only shows entities with values, the customization page shows all. If an entity has no value then it is supported by EMS-ESP, but not by your boiler/thermostat/etc.</p> <p><img alt=Web src=../_media/screenshot/web_customizations.png></p> <h2 id=scheduling-actions>Scheduling Actions<a class=headerlink href=#scheduling-actions title="Permanent link">~</a></h2> <p>Use the scheduler to call commands at specific intervals. This is useful for example to set the hot water temperature to a higher value in the morning and evening, or do a system restart each week (by using <code>system/restart</code> in the Command field).</p> <p>When creating a scheduler entry, the <code>name</code> is optional but it's useful to assign a name and then you can control it via a command (enable/disable) and see the status in the MQTT topic <code>scheduler_data</code>.</p> <p><img alt=Web src=../_media/screenshot/web_scheduler.png></p> <p>The scheduler can also be used to periodically set values based on another entity value, or even a user-defined custom entity (variable). For example to set the flow temperature of the boiler every minute based on a user managed entity which is controlled externally (e.g. in Home Assistant) it would look like:</p> <p><img alt=Web src=../_media/screenshot/web_scheduler_custom.png> <img alt=Web src=../_media/screenshot/web_scheduler_flowtemp.png></p> <h3 id=conditions>Conditions<a class=headerlink href=#conditions title="Permanent link">~</a></h3> <p>Introduced in <strong>version 3.7</strong>, the Scheduler has been extended to support conditional statements used in the <code>Command</code> and/or <code>Value</code> fields. Conditions have a strict syntax (see below) and are evaluated every 10 seconds. The condition is only executed when the condition changes from false to true. This is powerful new feature and allows, for example, to set a schedule based on a condition, or to set a value based on a condition.</p> <p>Pay attention to the following rules:</p> <ul> <li>a condition has to be a logic value <code>0</code> or <code>1</code>, the condition is <code>true</code> only for <code>1</code>, an arithmetic result <code>1</code> is also interpreted as <code>true</code> schedule command executed for <code>3 &gt; 2, 3 - 2</code> schedule command not executed for <code>3 &lt; 2</code>, <code>3 + 2</code></li> <li>blanks are not needed, but makes the formula more readable</li> <li>EMS-ESP values are accessed <code>&lt;device&gt;/&lt;entity&gt;</code> or <code>&lt;device&gt;/&lt;entity&gt;/value</code>, <code>&lt;entity&gt;</code> may contain prefixes like <code>&lt;hc2&gt;</code>.</li> <li>checking enum and bool values depends on the user's API setting! Check the right value before setting a schedule e.g. check output <a href=http://ems-esp.local/api/thermostat>http://ems-esp.local/api/thermostat</a> to see if building = "medium", create the rule with <code>thermostat/building == medium</code> also for boolean values check if you have to use <code>0/1</code>, <code>off/on</code>, <code>OFF/ON</code>, or <code>false/true</code></li> <li>strings containing special characters have to be written in quotations, e.g. <code>boiler/pumpmode == "delta-P2"</code>, to avoid a calculation error on delta minus P2, other strings can be written with or without quotations</li> <li>all strings are converted to lowercase</li> <li>commands followed by a divider (<code>/</code>) have to be set in parenthesis e.g. <code>(boiler/seltemp)/2</code></li> <li>condition command is only executed on a change of the condition from <code>false</code> to <code>true</code>. If the condition stays true, the command is not repeated</li> <li>command value can also be a formula</li> <li>allowed operations : arithmetic: <code>+ - \* / %</code> and prefix- logic: <code>== != &lt;= &gt;= &lt; &gt; &amp;&amp; ||</code> and prefix <code>!</code> are useful for the value of onChange and condition: a single instance of <code>&lt;cond1&gt; ? &lt;cond2&gt; : &lt;cond3&gt;</code></li> <li>on change trigger is always one or more entities <code>&lt;device&gt;/&lt;entity&gt;</code>, where device is not system. It can have multiple triggers. e.g. <code>boiler/outdoortemp custom/setpoint</code> and triggers on change of each value (entities never change the same time (it's a callback) and logical operations here like <code>&amp;&amp;</code> makes no sense)</li> </ul> <p><img alt=Web src=../_media/screenshot/web_conditions_1.png></p> <p><img alt=Web src=../_media/screenshot/web_conditions_2.png></p> <h3 id=web-commands>Web Commands<a class=headerlink href=#web-commands title="Permanent link">~</a></h3> <p>Sending or getting data via web request can be used in a json command: - GET a value from webserver: <code>{"url":"http://server.tld/path/file"}</code> - GET a json value from webserver and select the key: <code>{"url":"http://server.tld/path/file", "key":"nameofkey"}</code> - set a value with POST: Command: <code>{"url":"http://server.tld/path/file", "header":{"content-type":"text/plain", "token":"mytoken"}</code> Value: the post message, if it is a json the content-type header is set in header, no need to set it.</p> <p>Examples: - getting power state of a tasmota plug (exampleIP): <code>{"url":"http://192.168.0.100/cm?cmnd=power", "key":"power"} == off</code> is identical with <code>{"url":"http://192.168.0.100/cm?cmnd=power"} == {"power":"off"}</code> - setting a tasmoto plug: <code>{"url":"http://192.168.0.100/cm?cmnd=power%20on"}</code></p> <h3 id=notification>Notification<a class=headerlink href=#notification title="Permanent link">~</a></h3> <p>With web commands a service like <a href=https://pushover.net>pushover</a> can be used to send a push-message on events. To send different message create a custom entity in RAM named <code>message</code>, or what you like. Create a schedule on change triggering the change of this message and sending the pushover message.</p> <p><img alt=grafik src=https://github.com/user-attachments/assets/570576b5-b382-4ab2-bff3-4468291334a3></p> <p>Now you can create other scheduls with the command <code>custom/message</code> and individual text as data.</p> <h2 id=adding-custom-entities>Adding Custom Entities<a class=headerlink href=#adding-custom-entities title="Permanent link">~</a></h2> <p>Custom Entities is an advanced and powerful way to extend EMS-ESP by adding your own EMS entities that extracts data from a specific EMS telegram. This is useful when EMS-ESP doesn't yet support a specific entity, or when you want to extract data from a telegram that is not yet supported. Another common use case is for debugging or watching specific behavior when changing parameters on an EMS device.</p> <p>For example, a modern Heat Pump may have new features that are not included in EMS-ESP. Here you would use the <code>watch</code> command to view the incoming EMS traffic in combination with manual adjusting specific parameters and when you have located the specific telegram and the offset, create a Custom Entity to fine-tune the type and verify the the value. Then request it to be included in the next EMS-ESP release update.</p> <p><img alt=Web src=../_media/screenshot/web_customentities.png></p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">August 1, 2024</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/MichaelDvP class=md-author title=@MichaelDvP> <img src="https://avatars.githubusercontent.com/u/59284019?v=4&size=72" alt=MichaelDvP> </a> <a href=https://github.com/proddy class=md-author title=@proddy> <img src="https://avatars.githubusercontent.com/u/1230712?v=4&size=72" alt=proddy> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://discord.gg/3J3GgnzpyT target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://github.com/emsesp/EMS-ESP32 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.56dfad97.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../extra_javascript/tablesort.js></script> <script src=../extra_javascript/github.js></script> </body> </html>