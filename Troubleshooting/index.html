<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation (Wiki) for EMS-ESP"><link href=https://emsesp.org/Troubleshooting/ rel=canonical><link href=../Support/ rel=prev><link href=../FAQ/ rel=next><link rel=icon href=../_media/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.34"><title>Troubleshooting - EMS-ESP</title><link rel=stylesheet href=../assets/stylesheets/main.35f28582.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><link rel=stylesheet href=../assets/css/github.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-SVDSJ3QTVC"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-SVDSJ3QTVC",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-SVDSJ3QTVC",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#general class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=EMS-ESP class="md-header__button md-logo" aria-label=EMS-ESP data-md-component=logo> <img src=../_media/logo/boiler.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> EMS-ESP </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Troubleshooting </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-hidden=true type=radio name=__palette id=__palette_0> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/emsesp/EMS-ESP32 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> emsesp/EMS-ESP32 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../All-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../Integrations/ class=md-tabs__link> Integrations </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../Support/ class=md-tabs__link> Help </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=EMS-ESP class="md-nav__button md-logo" aria-label=EMS-ESP data-md-component=logo> <img src=../_media/logo/boiler.svg alt=logo> </a> EMS-ESP </label> <div class=md-nav__source> <a href=https://github.com/emsesp/EMS-ESP32 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> emsesp/EMS-ESP32 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> News </span> </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> <span class=md-ellipsis> About EMS-ESP </span> </a> </li> <li class=md-nav__item> <a href=../Version-Release-History/ class=md-nav__link> <span class=md-ellipsis> Version Release History </span> </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../Configuring/ class=md-nav__link> <span class=md-ellipsis> Configuring </span> </a> </li> <li class=md-nav__item> <a href=../Special-Functions/ class=md-nav__link> <span class=md-ellipsis> Special Functions </span> </a> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> <span class=md-ellipsis> WebUI </span> </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_9> <label class=md-nav__link for=__nav_1_9 id=__nav_1_9_label tabindex=0> <span class=md-ellipsis> Modbus/TCP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_9_label aria-expanded=false> <label class=md-nav__title for=__nav_1_9> <span class="md-nav__icon md-icon"></span> Modbus/TCP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Modbus/ class=md-nav__link> <span class=md-ellipsis> Modbus </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Settings/ class=md-nav__link> <span class=md-ellipsis> Settings </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Server-IDs/ class=md-nav__link> <span class=md-ellipsis> Server Unit Identifiers </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-System-Server/ class=md-nav__link> <span class=md-ellipsis> The SYSTEM Server </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Register-Blocks/ class=md-nav__link> <span class=md-ellipsis> Register Block Offsets </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Entity-Registers/ class=md-nav__link> <span class=md-ellipsis> Entity Register Offsets </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../Console/ class=md-nav__link> <span class=md-ellipsis> Console </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_12> <label class=md-nav__link for=__nav_1_12 id=__nav_1_12_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_12_label aria-expanded=false> <label class=md-nav__title for=__nav_1_12> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../All-Devices/ class=md-nav__link> <span class=md-ellipsis> All Devices and Entities </span> </a> </li> <li class=md-nav__item> <a href=../Boilers/ class=md-nav__link> <span class=md-ellipsis> Boilers </span> </a> </li> <li class=md-nav__item> <a href=../Thermostats/ class=md-nav__link> <span class=md-ellipsis> Thermostats </span> </a> </li> <li class=md-nav__item> <a href=../Solar-Modules/ class=md-nav__link> <span class=md-ellipsis> Solar Modules </span> </a> </li> <li class=md-nav__item> <a href=../Mixer-Modules/ class=md-nav__link> <span class=md-ellipsis> Mixer Modules </span> </a> </li> <li class=md-nav__item> <a href=../Heat-Pumps/ class=md-nav__link> <span class=md-ellipsis> Heat Pumps </span> </a> </li> <li class=md-nav__item> <a href=../Controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../Switches/ class=md-nav__link> <span class=md-ellipsis> Switches </span> </a> </li> <li class=md-nav__item> <a href=../Other-Devices/ class=md-nav__link> <span class=md-ellipsis> Other Devices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_13> <label class=md-nav__link for=__nav_1_13 id=__nav_1_13_label tabindex=0> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_13_label aria-expanded=false> <label class=md-nav__title for=__nav_1_13> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> </li> <li class=md-nav__item> <a href=../IOBroker/ class=md-nav__link> <span class=md-ellipsis> IOBroker </span> </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> <span class=md-ellipsis> Domoticz </span> </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> <span class=md-ellipsis> openHAB </span> </a> </li> <li class=md-nav__item> <a href=../Loxone/ class=md-nav__link> <span class=md-ellipsis> Loxone </span> </a> </li> <li class=md-nav__item> <a href=../Grafana/ class=md-nav__link> <span class=md-ellipsis> Grafana </span> </a> </li> <li class=md-nav__item> <a href=../Modbus/ class=md-nav__link> <span class=md-ellipsis> Modbus </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_14> <label class=md-nav__link for=__nav_1_14 id=__nav_1_14_label tabindex=0> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_14_label aria-expanded=false> <label class=md-nav__title for=__nav_1_14> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Support/ class=md-nav__link> <span class=md-ellipsis> Support </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#general class=md-nav__link> <span class=md-ellipsis> General </span> </a> <nav class=md-nav aria-label=General> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cant-connect-to-the-wifi class=md-nav__link> <span class=md-ellipsis> Can't connect to the WiFi </span> </a> </li> <li class=md-nav__item> <a href=#the-led-is-constantly-flashing class=md-nav__link> <span class=md-ellipsis> The LED is constantly flashing </span> </a> </li> <li class=md-nav__item> <a href=#ems-esp-often-restarts class=md-nav__link> <span class=md-ellipsis> EMS-ESP often restarts </span> </a> </li> <li class=md-nav__item> <a href=#ems-esp-freezes class=md-nav__link> <span class=md-ellipsis> EMS-ESP freezes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ems-data-and-connectivity class=md-nav__link> <span class=md-ellipsis> EMS Data and Connectivity </span> </a> <nav class=md-nav aria-label="EMS Data and Connectivity"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#not-all-ems-devices-are-recognized class=md-nav__link> <span class=md-ellipsis> Not all EMS devices are recognized </span> </a> </li> <li class=md-nav__item> <a href=#im-missing-certain-data-from-an-ems-device class=md-nav__link> <span class=md-ellipsis> I'm missing certain data from an EMS device </span> </a> </li> <li class=md-nav__item> <a href=#many-rx-errors class=md-nav__link> <span class=md-ellipsis> Many Rx errors </span> </a> </li> <li class=md-nav__item> <a href=#ems-bus-is-not-connecting class=md-nav__link> <span class=md-ellipsis> EMS Bus is not connecting </span> </a> </li> <li class=md-nav__item> <a href=#changing-a-value-on-an-ems-device-doesnt-work class=md-nav__link> <span class=md-ellipsis> Changing a value on an EMS Device doesn't work </span> </a> </li> <li class=md-nav__item> <a href=#changing-a-value-works-at-first-but-is-then-reset-to-its-original-value class=md-nav__link> <span class=md-ellipsis> Changing a value works at first, but is then reset to it's original value </span> </a> </li> <li class=md-nav__item> <a href=#incorrect-values-are-shown-from-a-specific-device class=md-nav__link> <span class=md-ellipsis> Incorrect values are shown from a specific device </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dallas-sensors class=md-nav__link> <span class=md-ellipsis> Dallas Sensors </span> </a> <nav class=md-nav aria-label="Dallas Sensors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#unusual-dallas-sensor-readings class=md-nav__link> <span class=md-ellipsis> Unusual Dallas sensor readings </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mqtt class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> <nav class=md-nav aria-label=MQTT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#messages-are-not-always-coming-in-via-mqtt class=md-nav__link> <span class=md-ellipsis> Messages are not always coming in via MQTT </span> </a> </li> <li class=md-nav__item> <a href=#commands-sent-via-mqtt-are-not-working class=md-nav__link> <span class=md-ellipsis> Commands sent via MQTT are not working </span> </a> </li> <li class=md-nav__item> <a href=#integration-with-home-assistant-breaks-when-mqtt-broker-restarts class=md-nav__link> <span class=md-ellipsis> Integration with Home Assistant breaks when MQTT broker restarts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#home-assistant class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> <nav class=md-nav aria-label="Home Assistant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ha-is-showing-errors-like-received-message-on-illegal-discovery-topic-or-template-variable-warning-dict-object-has-no-attribute class=md-nav__link> <span class=md-ellipsis> HA is showing errors like "Received message on illegal discovery topic" or "Template variable warning: 'dict object' has no attribute..." </span> </a> </li> <li class=md-nav__item> <a href=#ha-has-duplicate-entities-prefixed-with-_2 class=md-nav__link> <span class=md-ellipsis> HA has duplicate entities, prefixed with _2 </span> </a> </li> <li class=md-nav__item> <a href=#ha-has-messed-up-the-names-of-my-entities class=md-nav__link> <span class=md-ellipsis> HA has messed up the names of my entities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#specific-ems-settings class=md-nav__link> <span class=md-ellipsis> Specific EMS settings </span> </a> <nav class=md-nav aria-label="Specific EMS settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#thermostat-datetime class=md-nav__link> <span class=md-ellipsis> Thermostat Date/Time </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../tips-and-tricks/ class=md-nav__link> <span class=md-ellipsis> Tips & Tricks </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_15> <label class=md-nav__link for=__nav_1_15 id=__nav_1_15_label tabindex=0> <span class=md-ellipsis> For Developers </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_15_label aria-expanded=false> <label class=md-nav__title for=__nav_1_15> <span class="md-nav__icon md-icon"></span> For Developers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Building/ class=md-nav__link> <span class=md-ellipsis> Building & Testing the Firmware </span> </a> </li> <li class=md-nav__item> <a href=../Adding-Languages/ class=md-nav__link> <span class=md-ellipsis> Adding Languages </span> </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../EMS-bus/ class=md-nav__link> <span class=md-ellipsis> The EMS protocol </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Dev/ class=md-nav__link> <span class=md-ellipsis> Maintaining Modbus Parameters </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../All-Devices/ class=md-nav__link> <span class=md-ellipsis> All Devices and Entities </span> </a> </li> <li class=md-nav__item> <a href=../Boilers/ class=md-nav__link> <span class=md-ellipsis> Boilers </span> </a> </li> <li class=md-nav__item> <a href=../Thermostats/ class=md-nav__link> <span class=md-ellipsis> Thermostats </span> </a> </li> <li class=md-nav__item> <a href=../Solar-Modules/ class=md-nav__link> <span class=md-ellipsis> Solar Modules </span> </a> </li> <li class=md-nav__item> <a href=../Mixer-Modules/ class=md-nav__link> <span class=md-ellipsis> Mixer Modules </span> </a> </li> <li class=md-nav__item> <a href=../Heat-Pumps/ class=md-nav__link> <span class=md-ellipsis> Heat Pumps </span> </a> </li> <li class=md-nav__item> <a href=../Controllers/ class=md-nav__link> <span class=md-ellipsis> Controllers </span> </a> </li> <li class=md-nav__item> <a href=../Switches/ class=md-nav__link> <span class=md-ellipsis> Switches </span> </a> </li> <li class=md-nav__item> <a href=../Other-Devices/ class=md-nav__link> <span class=md-ellipsis> Other Devices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> </li> <li class=md-nav__item> <a href=../IOBroker/ class=md-nav__link> <span class=md-ellipsis> IOBroker </span> </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> <span class=md-ellipsis> Domoticz </span> </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> <span class=md-ellipsis> openHAB </span> </a> </li> <li class=md-nav__item> <a href=../Loxone/ class=md-nav__link> <span class=md-ellipsis> Loxone </span> </a> </li> <li class=md-nav__item> <a href=../Grafana/ class=md-nav__link> <span class=md-ellipsis> Grafana </span> </a> </li> <li class=md-nav__item> <a href=../Modbus/ class=md-nav__link> <span class=md-ellipsis> Modbus </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Support/ class=md-nav__link> <span class=md-ellipsis> Support </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#general class=md-nav__link> <span class=md-ellipsis> General </span> </a> <nav class=md-nav aria-label=General> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cant-connect-to-the-wifi class=md-nav__link> <span class=md-ellipsis> Can't connect to the WiFi </span> </a> </li> <li class=md-nav__item> <a href=#the-led-is-constantly-flashing class=md-nav__link> <span class=md-ellipsis> The LED is constantly flashing </span> </a> </li> <li class=md-nav__item> <a href=#ems-esp-often-restarts class=md-nav__link> <span class=md-ellipsis> EMS-ESP often restarts </span> </a> </li> <li class=md-nav__item> <a href=#ems-esp-freezes class=md-nav__link> <span class=md-ellipsis> EMS-ESP freezes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ems-data-and-connectivity class=md-nav__link> <span class=md-ellipsis> EMS Data and Connectivity </span> </a> <nav class=md-nav aria-label="EMS Data and Connectivity"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#not-all-ems-devices-are-recognized class=md-nav__link> <span class=md-ellipsis> Not all EMS devices are recognized </span> </a> </li> <li class=md-nav__item> <a href=#im-missing-certain-data-from-an-ems-device class=md-nav__link> <span class=md-ellipsis> I'm missing certain data from an EMS device </span> </a> </li> <li class=md-nav__item> <a href=#many-rx-errors class=md-nav__link> <span class=md-ellipsis> Many Rx errors </span> </a> </li> <li class=md-nav__item> <a href=#ems-bus-is-not-connecting class=md-nav__link> <span class=md-ellipsis> EMS Bus is not connecting </span> </a> </li> <li class=md-nav__item> <a href=#changing-a-value-on-an-ems-device-doesnt-work class=md-nav__link> <span class=md-ellipsis> Changing a value on an EMS Device doesn't work </span> </a> </li> <li class=md-nav__item> <a href=#changing-a-value-works-at-first-but-is-then-reset-to-its-original-value class=md-nav__link> <span class=md-ellipsis> Changing a value works at first, but is then reset to it's original value </span> </a> </li> <li class=md-nav__item> <a href=#incorrect-values-are-shown-from-a-specific-device class=md-nav__link> <span class=md-ellipsis> Incorrect values are shown from a specific device </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dallas-sensors class=md-nav__link> <span class=md-ellipsis> Dallas Sensors </span> </a> <nav class=md-nav aria-label="Dallas Sensors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#unusual-dallas-sensor-readings class=md-nav__link> <span class=md-ellipsis> Unusual Dallas sensor readings </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mqtt class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> <nav class=md-nav aria-label=MQTT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#messages-are-not-always-coming-in-via-mqtt class=md-nav__link> <span class=md-ellipsis> Messages are not always coming in via MQTT </span> </a> </li> <li class=md-nav__item> <a href=#commands-sent-via-mqtt-are-not-working class=md-nav__link> <span class=md-ellipsis> Commands sent via MQTT are not working </span> </a> </li> <li class=md-nav__item> <a href=#integration-with-home-assistant-breaks-when-mqtt-broker-restarts class=md-nav__link> <span class=md-ellipsis> Integration with Home Assistant breaks when MQTT broker restarts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#home-assistant class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> <nav class=md-nav aria-label="Home Assistant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ha-is-showing-errors-like-received-message-on-illegal-discovery-topic-or-template-variable-warning-dict-object-has-no-attribute class=md-nav__link> <span class=md-ellipsis> HA is showing errors like "Received message on illegal discovery topic" or "Template variable warning: 'dict object' has no attribute..." </span> </a> </li> <li class=md-nav__item> <a href=#ha-has-duplicate-entities-prefixed-with-_2 class=md-nav__link> <span class=md-ellipsis> HA has duplicate entities, prefixed with _2 </span> </a> </li> <li class=md-nav__item> <a href=#ha-has-messed-up-the-names-of-my-entities class=md-nav__link> <span class=md-ellipsis> HA has messed up the names of my entities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#specific-ems-settings class=md-nav__link> <span class=md-ellipsis> Specific EMS settings </span> </a> <nav class=md-nav aria-label="Specific EMS settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#thermostat-datetime class=md-nav__link> <span class=md-ellipsis> Thermostat Date/Time </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../tips-and-tricks/ class=md-nav__link> <span class=md-ellipsis> Tips & Tricks </span> </a> </li> <li class=md-nav__item> <a href=../Contact/ class=md-nav__link> <span class=md-ellipsis> Contact </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#general class=md-nav__link> <span class=md-ellipsis> General </span> </a> <nav class=md-nav aria-label=General> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cant-connect-to-the-wifi class=md-nav__link> <span class=md-ellipsis> Can't connect to the WiFi </span> </a> </li> <li class=md-nav__item> <a href=#the-led-is-constantly-flashing class=md-nav__link> <span class=md-ellipsis> The LED is constantly flashing </span> </a> </li> <li class=md-nav__item> <a href=#ems-esp-often-restarts class=md-nav__link> <span class=md-ellipsis> EMS-ESP often restarts </span> </a> </li> <li class=md-nav__item> <a href=#ems-esp-freezes class=md-nav__link> <span class=md-ellipsis> EMS-ESP freezes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ems-data-and-connectivity class=md-nav__link> <span class=md-ellipsis> EMS Data and Connectivity </span> </a> <nav class=md-nav aria-label="EMS Data and Connectivity"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#not-all-ems-devices-are-recognized class=md-nav__link> <span class=md-ellipsis> Not all EMS devices are recognized </span> </a> </li> <li class=md-nav__item> <a href=#im-missing-certain-data-from-an-ems-device class=md-nav__link> <span class=md-ellipsis> I'm missing certain data from an EMS device </span> </a> </li> <li class=md-nav__item> <a href=#many-rx-errors class=md-nav__link> <span class=md-ellipsis> Many Rx errors </span> </a> </li> <li class=md-nav__item> <a href=#ems-bus-is-not-connecting class=md-nav__link> <span class=md-ellipsis> EMS Bus is not connecting </span> </a> </li> <li class=md-nav__item> <a href=#changing-a-value-on-an-ems-device-doesnt-work class=md-nav__link> <span class=md-ellipsis> Changing a value on an EMS Device doesn't work </span> </a> </li> <li class=md-nav__item> <a href=#changing-a-value-works-at-first-but-is-then-reset-to-its-original-value class=md-nav__link> <span class=md-ellipsis> Changing a value works at first, but is then reset to it's original value </span> </a> </li> <li class=md-nav__item> <a href=#incorrect-values-are-shown-from-a-specific-device class=md-nav__link> <span class=md-ellipsis> Incorrect values are shown from a specific device </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#dallas-sensors class=md-nav__link> <span class=md-ellipsis> Dallas Sensors </span> </a> <nav class=md-nav aria-label="Dallas Sensors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#unusual-dallas-sensor-readings class=md-nav__link> <span class=md-ellipsis> Unusual Dallas sensor readings </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mqtt class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> <nav class=md-nav aria-label=MQTT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#messages-are-not-always-coming-in-via-mqtt class=md-nav__link> <span class=md-ellipsis> Messages are not always coming in via MQTT </span> </a> </li> <li class=md-nav__item> <a href=#commands-sent-via-mqtt-are-not-working class=md-nav__link> <span class=md-ellipsis> Commands sent via MQTT are not working </span> </a> </li> <li class=md-nav__item> <a href=#integration-with-home-assistant-breaks-when-mqtt-broker-restarts class=md-nav__link> <span class=md-ellipsis> Integration with Home Assistant breaks when MQTT broker restarts </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#home-assistant class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> <nav class=md-nav aria-label="Home Assistant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ha-is-showing-errors-like-received-message-on-illegal-discovery-topic-or-template-variable-warning-dict-object-has-no-attribute class=md-nav__link> <span class=md-ellipsis> HA is showing errors like "Received message on illegal discovery topic" or "Template variable warning: 'dict object' has no attribute..." </span> </a> </li> <li class=md-nav__item> <a href=#ha-has-duplicate-entities-prefixed-with-_2 class=md-nav__link> <span class=md-ellipsis> HA has duplicate entities, prefixed with _2 </span> </a> </li> <li class=md-nav__item> <a href=#ha-has-messed-up-the-names-of-my-entities class=md-nav__link> <span class=md-ellipsis> HA has messed up the names of my entities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#specific-ems-settings class=md-nav__link> <span class=md-ellipsis> Specific EMS settings </span> </a> <nav class=md-nav aria-label="Specific EMS settings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#thermostat-datetime class=md-nav__link> <span class=md-ellipsis> Thermostat Date/Time </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Troubleshooting</h1> <p>Below are answers to some common problems.</p> <h2 id=general>General<a class=headerlink href=#general title="Permanent link">~</a></h2> <h3 id=cant-connect-to-the-wifi>Can't connect to the WiFi<a class=headerlink href=#cant-connect-to-the-wifi title="Permanent link">~</a></h3> <p>The EMS-ESP is probably in Access Point mode. Look for a wifi SSID <code>ems-esp</code>, connect to this and open a browser to '<a href=http://192.168.4.1>http://192.168.4.1</a>'. If you have configured a WiFi client your router would have appointed an IP address via DHCP. You should be able to then connect via <a href=https://ems-esp>https://ems-esp</a> or <a href=https://ems-esp.local>https://ems-esp.local</a>.</p> <p>On boards with Ethernet, Ethernet will be disabled if a WiFi SSID exists. If you want to use Ethernet, set this clear this setting.</p> <h3 id=the-led-is-constantly-flashing>The LED is constantly flashing<a class=headerlink href=#the-led-is-constantly-flashing title="Permanent link">~</a></h3> <p>A fast pulse of the LED means the system is booting or in installation mode. Connect via the WiFi to its Access Point (<code>ems-esp</code>) to complete the configuration.</p> <p>A slow pulse means either there is no WiFi connection or EMS-ESP cannot read from the EMS bus. In this case go to the Web interface and try a different Tx Mode setting.</p> <p>See the explanation on <a href=../Getting-Started/#what-the-onboard-led-is-telling-you>what the LED shows</a>.</p> <h3 id=ems-esp-often-restarts>EMS-ESP often restarts<a class=headerlink href=#ems-esp-often-restarts title="Permanent link">~</a></h3> <p>A healthy gateway/interface board running EMS-ESP should run happily for long periods without spontaneous restarts so, if yours is restarting by itself at random intervals, then something's not right.</p> <p>Record how often it crashes and whether there is any relation to activity on the network (e.g. wifi or mqtt reconnecting) or something incoming/outgoing to one of the EMS devices. A good way to spot this is to use Home Assistant or simple MQTT Explorer to watch the system up time.</p> <p>Things to check:</p> <h4 id=it-may-be-power-related>It may be power related<a class=headerlink href=#it-may-be-power-related title="Permanent link">~</a></h4> <ul> <li>Power down the gateway and check wiring connections are secure. Check that the ESP32, DC-DC converter and any jumpers on the gateway are securely seated onto their connectors.</li> <li>Try powering the gateway from the ESP32's USB socket (check the <a href=https://bbqkees-electronics.nl/wiki/ >wiki</a> for how to do this on your particular gateway model). If the restarts stop, then you've got a problem with the external power source (BUS or service jack) or the DC-DC converter inside the gateway.</li> <li>If on WiFi, try reducing the WiFi Tx Power to 10 dBm from the <code>Network Settings</code> page and see if that helps.</li> </ul> <h4 id=it-may-be-memory-related>It may be memory related<a class=headerlink href=#it-may-be-memory-related title="Permanent link">~</a></h4> <p>The ESP32 has very limited RAM, split between run-time stack and the heap. The heap can quickly become fragmented reducing the maximum size of a buffer, and we use A LOT of buffers to prepare all that lovely JSON files for sending to MQTT and populating the Web pages. When the ESP32 runs out of available it will simply restart itself. Things to check:</p> <ul> <li>If the WebUI is accessible, go to <code>System-&gt;System Status</code> and look at the Heap. If the Free memory is below 90KB or the Max allocation below 45KB then that may be an issue and you'll need to turn off services, try again and report this. Start by disabling mDNS and SysLog (if running) one by one and see if that helps.</li> <li>Make sure the System Log's Max Buffer Size at <code>System-&gt;System Log</code> is at its lowest (25).</li> <li>Each network protocol (Ethernet, Wifi, AP) consumes memory. If you're only using Ethernet (e.g. an BBQKees E32 Gateway) switch off WiFi and the Access Point (use a blank WiFI ssid).</li> <li>If you have many EMS entities use the Customizations page and set any unused entities (shown by having a blank value) to "remove from memory".</li> </ul> <h4 id=it-could-be-code-related>It could be code related<a class=headerlink href=#it-could-be-code-related title="Permanent link">~</a></h4> <ul> <li>Go to <code>System-&gt;System Log</code> and set the <code>Log Level</code> to <code>INFO</code>. This will make sure you'll see the restart log at the top next time it restarts. It'll show something similar to <code>2022-12-30 11:58:02.000 INFO 0: [emsesp] Last system reset reason Core0: Software reset CPU, Core1: Software reset CPU</code>.</li> <li>And finally, if none of the above works then the problem is the core processing the incoming telegrams. Try and capture some logs just before it crashes (using SysLog is good for this) and post the information in a new GitHub issue.</li> </ul> <h3 id=ems-esp-freezes>EMS-ESP freezes<a class=headerlink href=#ems-esp-freezes title="Permanent link">~</a></h3> <p>If EMS-ESP becomes unresponsive, as in it appears to be active and hasn't restarted itself but accessing either the telnet console, the webUI or simply responding to ping fails then EMS-ESP has gone into a network loop. We have seen this behavior with Mesh'd WiFi Access Points and also unstable MQTT servers, and coded fail-safe's to avoid them. If you do encounter this annoying problem then first try setting a BSSID (only if using WiFi). Otherwise please report it on GitHub along with this additional information:</p> <ul> <li>the System Info (so we can see version, MQTT config and any errors)</li> <li>any signs of LEDs (on the board/gateway) or the Ethernet port if using an E32 Gateway</li> <li>description of your network (which vendor, WiFi or Ethernet, etc)</li> <li>any anomalies in the network (servers down, Access point roaming, channel switching etc)</li> </ul> <h2 id=ems-data-and-connectivity>EMS Data and Connectivity<a class=headerlink href=#ems-data-and-connectivity title="Permanent link">~</a></h2> <h3 id=not-all-ems-devices-are-recognized>Not all EMS devices are recognized<a class=headerlink href=#not-all-ems-devices-are-recognized title="Permanent link">~</a></h3> <p>Experiment with changing the Tx Mode value in the Settings page. The default EMS works for older EMS1.0 systems, EMS2 or EMSPlus systems and HT3 for Junkers/Worcester using the Heatronics protocol.</p> <p>If you have EMS devices that may not yet be supported by EMS-ESP then use <code>scan</code> or <code>scan deep</code> from the Console to find out their details and then post an enhancement issue on GitHub. Remember the <code>su</code> password is default <code>ems-esp-neo</code> unless this has been changed via the console (<code>passwd</code>) or in the WebUI (<code>Security-&gt;Security Settings</code>). For example:</p> <div class=highlight><pre><span></span><code>ems-esp:$<span class=w> </span>su
Password:
<span class=m>000</span>+00:01:38.291<span class=w> </span>N<span class=w> </span><span class=m>0</span>:<span class=w> </span><span class=o>[</span>shell<span class=o>]</span><span class=w> </span>Admin<span class=w> </span>session<span class=w> </span>opened<span class=w> </span>on<span class=w> </span>console
ems-esp:#<span class=w> </span>scan
<span class=m>000</span>+00:01:41.034<span class=w> </span>N<span class=w> </span><span class=m>1</span>:<span class=w> </span><span class=o>[</span>emsesp<span class=o>]</span><span class=w> </span>Unrecognized<span class=w> </span>EMS<span class=w> </span>device<span class=w> </span><span class=o>(</span>device<span class=w> </span>ID<span class=w> </span>0x08,<span class=w> </span>product<span class=w> </span>ID<span class=w> </span><span class=m>123</span><span class=o>)</span>.<span class=w> </span>Please<span class=w> </span>report<span class=w> </span>on<span class=w> </span>GitHub.
ems-esp:#
</code></pre></div> <p>If you want to see the EMS data streaming in, use the <code>watch</code> command. See <a href="../Console/?id=monitoring-the-ems-traffic.md">Console</a>.</p> <h3 id=im-missing-certain-data-from-an-ems-device>I'm missing certain data from an EMS device<a class=headerlink href=#im-missing-certain-data-from-an-ems-device title="Permanent link">~</a></h3> <p>If data is missing then this is where we need your help to expand our database. Try and locate which telegram could contain the data by making the change on the device (e.g. boiler or thermostat) with EMS-ESP running and looking at the System Log in Trace mode to spot which commands are being sent and what the new values are from incoming telegrams.</p> <p>When you have located the telegram, find the offset and use the <code>Custom Entities</code> page in the WebUI to create a new entity which you can then test. Pay attention to the Unit of Measure. Then take a screenshot of this screen and post it to a new GitHub issue, along with a suitable 'long' name and a 'short' name in English and your native language, which will allow us to quickly implement it in the code.</p> <p>Note that not all EMS devices allow their data to be published on the EMS bus, for example the smart thermostats like the Nefit Easy and Buderus Easy Control CT200 which only transmits the current room and setpoint temperatures as read-only attributes.</p> <p>See this article on <a href="../FAQ/?id=decoding-ems-telegrams.md">Decoding EMS Telegrams</a> for more information.</p> <h3 id=many-rx-errors>Many Rx errors<a class=headerlink href=#many-rx-errors title="Permanent link">~</a></h3> <p>It is quite usual to see a few warnings in the log about incomplete telegrams. This could be due to interference on the line, inadequate power or a wrong Tx Mode. The warnings are usually harmless as EMS-ESP will either wait for the next broadcast or keep trying to fetch the telegram. If you're seeing an Rx quality less than 80% then try:</p> <ul> <li>a different Tx Mode, for example switch between EMS+ and EMS.</li> <li>powering the EMS-ESP by USB or service-jack. We've seen examples where a noisy or failing DC supply can cause RX Fail or incomplete telegrams and trying USB power (check how to switch to USB powering in the <a href=https://bbqkees-electronics.nl/wiki/ >BBQKees wiki</a>) can help track this down.</li> <li>removing disruptions on the bus line from emc, reflections, other units. Connect the EMS-ESP to another device on the bus. In general a previously unconnected bus-out on a devices like MM100 is better than a split connection on an already used connector.</li> </ul> <h3 id=ems-bus-is-not-connecting>EMS Bus is not connecting<a class=headerlink href=#ems-bus-is-not-connecting title="Permanent link">~</a></h3> <p>If you're using the EMS wires, on some systems the order is important. Try switching them!</p> <p>A BBQKees Gateway is DCE, and the ESP32s are DTE so you have to connect TX(esp)-TX(gateway) and RX-RX. TX on the ESP32 is sending data, TX on gateway is the input for sending data to the ems-bus. Note a crossed (nullmodem) connection is only used for DTE-DTE connections.</p> <p>The most common wiring mistake though is that when people connect the interface board to an ESP32 module, they connect it to the pins marked TX and RX on the ESP32 module. If you're unsure of which pins to use, go to EMS-ESP Settings, select the Interface Board Profile for your board and select 'Custom' to view the default assigned GPIOs.</p> <h3 id=changing-a-value-on-an-ems-device-doesnt-work>Changing a value on an EMS Device doesn't work<a class=headerlink href=#changing-a-value-on-an-ems-device-doesnt-work title="Permanent link">~</a></h3> <p>If you notice that setting/writing an EMS device value has no effect then from the WebUI set the System Log level to DEBUG and repeat the action, noticing any errors or warnings in the System Log. For a more thorough analysis use the Telnet Console, <code>su</code>, then <code>log debug</code> and then repeat the action using the <code>call</code> command. Post the output to a new GitHub issue as described in the <a href=../Support/ >Support Section</a>.</p> <p>Note on some systems with for example a gateway or controller attached, any change will be reset or overwritten. This is just the behavior of the other master controllers and not much we can do about it.</p> <h3 id=changing-a-value-works-at-first-but-is-then-reset-to-its-original-value>Changing a value works at first, but is then reset to it's original value<a class=headerlink href=#changing-a-value-works-at-first-but-is-then-reset-to-its-original-value title="Permanent link">~</a></h3> <p>It may occur in some scenarios that EMS changes will be overwritten or ignored by another connected EMS device. For example when using <code>heatingactivated</code> to turn off the heating. A solution here is to send 0 to <code>boiler/selflowtemp</code> every few seconds.</p> <p>Certain boilers with manual temperature knobs/dials will override any EMS-ESP settings. To change a temperature value via EMS-ESP make sure the value you are sending is less than what the boiler is psychically set to via the dial. The boiler will reset itself to the dialed in value every 2 minutes so use EMS-ESP's Scheduler to reset the temperature value automatically every minute.</p> <h3 id=incorrect-values-are-shown-from-a-specific-device>Incorrect values are shown from a specific device<a class=headerlink href=#incorrect-values-are-shown-from-a-specific-device title="Permanent link">~</a></h3> <p>If you notice that certain values are displayed incorrectly, either in the WebUI, Console or MQTT then please help us correct this by logging a GitHub issue, along with the expected value. When asked to provide debug information, go the Telnet console and do</p> <div class=highlight><pre><span></span><code>%<span class=w> </span>su
%<span class=w> </span>log<span class=w> </span>trace
</code></pre></div> <p>and then either a <code>read</code> or <code>watch</code>, e.g. <code>read 21 2D8</code> to show all the data from HC2 on a Mixing MM100.</p> <h2 id=dallas-sensors>Dallas Sensors<a class=headerlink href=#dallas-sensors title="Permanent link">~</a></h2> <h3 id=unusual-dallas-sensor-readings>Unusual Dallas sensor readings<a class=headerlink href=#unusual-dallas-sensor-readings title="Permanent link">~</a></h3> <p>If you're seeing unusual Dallas sensor readings (crazy negative temperatures, sudden spikes in readings etc.) check...</p> <ul> <li>Wiring to the JST connector on the gateway.</li> <li>That you're in the right powering mode for your application : parasitic or non-parasitic</li> <li>Whether powering from USB fixes the issue (the <a href=https://bbqkees-electronics.nl/wiki/ >wiki</a> explains how to switch to/from USB power for your model of gateway). If it does, this might suggest a problem with power to the gateway from the BUS or service jack connectors.</li> </ul> <h2 id=mqtt>MQTT<a class=headerlink href=#mqtt title="Permanent link">~</a></h2> <h3 id=messages-are-not-always-coming-in-via-mqtt>Messages are not always coming in via MQTT<a class=headerlink href=#messages-are-not-always-coming-in-via-mqtt title="Permanent link">~</a></h3> <p>If you're noticing that MQTT messages are failing to arrive at the broker try:</p> <ul> <li>Check the EMS-ESP logs for errors. If you see "low memory" errors then read <a href="./?id=general.md#it-may-be-memory-related">It may be memory related</a> to see how you reduce memory usage.</li> <li>Check the broker for errors. You have incorrect credentials or duplicate Client IDs</li> <li>Set the log level to Debug (via Web or Console) and monitor the traffic</li> <li>Use Console to force a publish to see what happens. (<code>log debug</code>, <code>su</code> and <code>publish</code>).</li> <li>Increase the Publish Time. Perhaps there are too many messages and it is flooding the queue</li> <li> <p>If all fails, run a local copy of the MQTT mosquitto broker, in verbose mode (-v) so you see if there are errors</p> </li> <li> <p>download the latest version 2 of Mosquitto from <code>https://mosquitto.org/download/</code></p> </li> <li>create a new <code>mosquitto.conf</code> file with:</li> </ul> <div class=highlight><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">listener 1883</span>
<span class="l l-Scalar l-Scalar-Plain">allow_anonymous true</span>
</code></pre></div> <p>(or just edit the default <code>mosquitto.conf</code> and modify the <code>allow_anonymous</code> entry)</p> <ul> <li>run with the -v flag so you see all the verbose messages, e.g. on Windows its:</li> </ul> <div class=highlight><pre><span></span><code>&quot;C:\Program Files\mosquitto\mosquitto.exe&quot; -v -c &quot;C:\Program Files\mosquitto\mosquitto.conf&quot;
</code></pre></div> <h3 id=commands-sent-via-mqtt-are-not-working>Commands sent via MQTT are not working<a class=headerlink href=#commands-sent-via-mqtt-are-not-working title="Permanent link">~</a></h3> <p>Use the Console to manually test the commands, with logging on. For example if changing the thermostat temperature is not working try:</p> <div class=highlight><pre><span></span><code>ems-esp:$<span class=w> </span>su
ems-esp:#<span class=w> </span>log<span class=w> </span>debug
ems-esp:#<span class=w> </span>call<span class=w> </span>thermostat<span class=w> </span>seltemp<span class=w> </span><span class=m>15</span>
</code></pre></div> <p>You should see a log statement pop in the console like <code>[thermostat] Setting thermostat temperature to 15.0 for heating circuit 1, mode auto</code> followed by which telegrams are being sent. If you see log errors then create a GitHub issue (see <a href=../Support/ >Support</a>).</p> <h3 id=integration-with-home-assistant-breaks-when-mqtt-broker-restarts>Integration with Home Assistant breaks when MQTT broker restarts<a class=headerlink href=#integration-with-home-assistant-breaks-when-mqtt-broker-restarts title="Permanent link">~</a></h3> <p>The integration with Home Assistant uses MQTT Discovery which are 'retained' topics in the MQTT broker. If the MQTT service stops and restarts and the MQTT server is not saving the topics in a database then these messages will obviously be lost and the integration with Home Assistant removed. To solve this add persistance to your MQTT service. For example using Mosquitto a <code>.conf</code> file would look like:</p> <div class=highlight><pre><span></span><code>listener 1883
allow_anonymous true
persistence true
persistence_location /mosquitto/data/
log_dest file /mosquitto/log/mosquitto.log
</code></pre></div> <p>To read up more on this visit <a href=https://pagefault.blog/2020/02/05/how-to-set-up-persistent-storage-for-mosquitto-mqtt-broker>https://pagefault.blog/2020/02/05/how-to-set-up-persistent-storage-for-mosquitto-mqtt-broker</a>.</p> <p>An alternative option without using persistance on the MQTT server is to tell EMS-ESP to republish all the Home Assistant MQTT topics. You can do this via the EMS-ESP WebUI from version 3.4 and higher.</p> <h2 id=home-assistant>Home Assistant<a class=headerlink href=#home-assistant title="Permanent link">~</a></h2> <h3 id=ha-is-showing-errors-like-received-message-on-illegal-discovery-topic-or-template-variable-warning-dict-object-has-no-attribute>HA is showing errors like <em>"Received message on illegal discovery topic"</em> or <em>"Template variable warning: 'dict object' has no attribute..."</em><a class=headerlink href=#ha-is-showing-errors-like-received-message-on-illegal-discovery-topic-or-template-variable-warning-dict-object-has-no-attribute title="Permanent link">~</a></h3> <p>This could happen when either upgrading from an earlier EMS-ESP version and some of the device entity names may have changed. Use a tool like MQTTExplorer to remove all the <code>homeassistant/sensor/ems-esp/*</code> and <code>homeassistant/*/ems-esp/*</code> topics from your MQTT broker and restart EMS-ESP.</p> <h3 id=ha-has-duplicate-entities-prefixed-with-_2>HA has duplicate entities, prefixed with _2<a class=headerlink href=#ha-has-duplicate-entities-prefixed-with-_2 title="Permanent link">~</a></h3> <p>See @swa72's fix <a href=https://github.com/swa72/home-assistant/blob/main/README-mqtt.md>here</a>.</p> <h3 id=ha-has-messed-up-the-names-of-my-entities>HA has messed up the names of my entities<a class=headerlink href=#ha-has-messed-up-the-names-of-my-entities title="Permanent link">~</a></h3> <p>This happens, when HA make changes to MQTT Discovery. There's a nice tool called <a href=https://github.com/saladpanda/homeassistant-entity-renamer>homeassistant-entity-renamer</a> that can help you fix this.</p> <h2 id=specific-ems-settings>Specific EMS settings<a class=headerlink href=#specific-ems-settings title="Permanent link">~</a></h2> <h3 id=thermostat-datetime>Thermostat Date/Time<a class=headerlink href=#thermostat-datetime title="Permanent link">~</a></h3> <p>The correct format for setting the Thermostat time is:</p> <div class=highlight><pre><span></span><code>&lt; NTP | dd.mm.yyyy-hh:mm:ss-day(0-6)-dst(0/1) &gt;
</code></pre></div> <p>The thermostat needs a setting of day-of-week and daylight-saving. Bosch day-of-week is Mo-0, Su-6, unlike unix-time.</p> <p>If you have enabled NTP you can just enter "NTP" and the ntp time is set to the thermostat.</p> <p>With NTP enabled the thermostat clock is also automatically set by EMS-ESP if it differs from the ntp time.</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 9, 2024</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/proddy class=md-author title=@proddy> <img src="https://avatars.githubusercontent.com/u/1230712?v=4&size=72" alt=proddy> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 emsesp.org (@proddy, @MichaelDvP) </div> </div> <div class=md-social> <a href=https://discord.gg/3J3GgnzpyT target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://github.com/emsesp/EMS-ESP32 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking"], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.56dfad97.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../extra_javascript/tablesort.js></script> <script src=../extra_javascript/github.js></script> </body> </html>